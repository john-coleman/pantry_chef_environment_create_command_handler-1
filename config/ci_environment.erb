{
  "authorization" => {
    "sudo" => {
      "groups" => [ "sysadmin", "EXAMPLE\\\\pantry" ],
      "users" => [ <%= @users.inject(""){|res, item| "#{res}\"#{item}\", " } %>"deploy", "ubuntu" ],
      "passwordless" => true,
      "include_sudoers_d" => true
    }
  },
  "build_agent" => {
    "git_ssh_path" => "C:\\Jenkins",
    "java_jdk_physical_path" => "C:/Program Files/Java/jdk1.7.0_40/bin",
    "jenkins_working_directory" => "C:\\Jenkins",
    "nuget_enable_package_restore" => true,
    "wonga_nuget" => {
      "repos" => [
        { "data_bag_id" => "cd_tools", "enabled" => true },
        { "data_bag_id" => "nuget_org", "enabled" => false },
        { "data_bag_id" => "wonga_3rd_party_libs", "enabled" => true },
        { "data_bag_id" => "wonga_artifactory_deploy", "enabled" => true },
        { "data_bag_id" => "wonga_artifactory_libs", "enabled" => true },
        { "data_bag_id" => "wonga_build_scripts", "enabled" => true }
      ],
      "username" => "<%= @config['chef']['wonga']['build_domain'] %>\\<%= @config['chef']['wonga']['build_username'] %>",
      "password" => "<%= @config['chef']['wonga']['build_password'] %>"
    },
    "wonga_sonar" => {
    <% if @message['sonar'] && @message['sonar_server_hostname'] %>
      "host_url" => "http://<%= @message['sonar_server_hostname'] %>:9000/",
      "jdbc_url" => "jdbc:mysql://<%= @message['sonar_server_hostname'] %>:3306/sonar?useUnicode=true&amp;characterEncoding=utf8",
      "jdbc_username" => "<%= @message['sonar_jdbc_username'] || @config['chef']['sonar_jdbc_username'] %>",
      "jdbc_password" => "<%= @message['sonar_jdbc_password'] || @config['chef']['sonar_jdbc_password'] %>",
    <% end %>
    }
  },
  "build-essential" => {
    "compile_time" => true
  },
  "iis" => {
    "accept_eula" => true
  },
  "java" => {
    "windows" => {
      "url" => "https://s3-eu-west-1.amazonaws.com/mirror/java/jdk-7u40-windows-x64.exe"
    }
  },
  "jenkins" => {
    "cli" => {
      "username" =>"<%= @config['chef']['wonga']['build_username'] %>",
      "password" =>"<%= @config['chef']['wonga']['build_password'] %>",
      "jvm_options" => "-Xmx50m -Xms5m"
    },
    "http_proxy" => {
      "host_name" =>"<%= @team_name %>.<%= @message['domain'] %>",
      "variant" => "nginx"
    },
    "node" => {
      "home" => "C:\\Jenkins",
      "service_user" => "<%= @config['chef']['wonga']['build_domain'] %>\\<%= @config['chef']['wonga']['build_username'] %>",
      "service_user_password" => "<%= @config['chef']['wonga']['build_password'] %>"
    },
    "server" => {
      "repo_url" => "http://pkg.jenkins-ci.org/debian-stable",
      "repo_key" => "http://pkg.jenkins-ci.org/debian-stable/jenkins-ci.org.key",
      "host" => "<%= @team_name %>.<%= @message['domain'] %>",
      "plugins" => [
        "active-directory",
        "ansicolor",
        "build-timeout",
        "gerrit-trigger",
        "git",
        "git-client",
        "github",
        "greenballs",
        "htmlpublisher",
        "jira",
        "ldap",
        "log-parser",
        "mailer",
        "msbuild",
        "nunit",
        "parameterized-trigger",
        "postbuildscript",
        "powershell",
        "radiatorviewplugin",
        "rebuild",
        "scm-sync-configuration",
        "throttle-concurrents",
        "translation",
        "versionnumber"
      ],
      "port" => 8080,
      "url" => "http://<%= @team_name %>.<%= @message['domain'] %>:8080"
    },
  },
  "nginx" => {
    "default_site_enabled" => false
  },
  "openssh" => {
    "client" => {
      "strict_host_key_checking" => "no"
    }
  },
  "postfix" => {
    "mail_type" => "client",
    "main" => {
      "mynetworks" => "<%= @config['chef']['postfix']['main']['mynetworks'] %>",
      "mydomain" => "<%= @message['domain'] %>",
      "relayhost" => "[smtp.example.com]"
    }
  },
  "snmp" => {
    "all_disk_min" => 102400,
    "include_all_disks" => true,
    "load_average" => {
      "max1" => "6",
      "max5" => "3",
      "max15" => "2"
    },
    "process_monitoring" => {
      "proc" => [
        "sshd"
      ]
    },
    "syscontact" => "<%= @config['chef']['snmp']['syscontact'] %>",,
    "syslocationPhysical" => "AWS ExampleVPC",
    "syslocationVirtual" => "AWS ExampleVPC"
  },
  "wonga" => {
    "batch_job_user" => "<%= @config['chef']['wonga']['build_username'] %>",
    "batch_job_password" => "<%= @config['chef']['wonga']['build_password'] %>",
    "jenkins" => {
      "git_user_data_bag" => "users",
      "git_user_data_bag_item" => "ProvisionerUsername",
      "git_ssh_hosts" => [
        {
          "host" => "github.com",
          "StrictHostKeyChecking" => "no",
          "User" => "git"
        },
        {
          "host" => "git.example.com",
          "StrictHostKeyChecking" => "no",
          "User" => "git2"
        },
        {
          "host" => "gerrit.example.com",
          "Port" => 29418,
          "StrictHostKeyChecking" => "no",
          "User" => "ProvisionerUsername"
        }
      ],
      "scm_sync_configuration_data_bag" => "<%= @team_name %>",
      "scm_sync_configuration_data_bag_item" => "jenkins_scm_sync_configuration_plugin"
    },
    "nservicebus_license" => {
      "domain" => "<%= @config['chef']['wonga']['build_domain'] %>",
      "user" => "<%= @config['chef']['wonga']['build_username'] %>",
      "password" => "<%= @config['chef']['wonga']['build_password'] %>",
      "aws_access_key_id" => "<%= @config['chef']['wonga']['chef_aws_access_key_id'] %>",
      "aws_secret_access_key" => "<%= @config['chef']['wonga']['chef_aws_secret_access_key'] %>"
    },
    "set_windows_locale" => [
      {
        "locale" => "en-UK",
        "user" => "<%= @config['chef']['wonga']['build_domain'] %>\\<%= @config['chef']['wonga']['build_username'] %>",
        "password" => "<%= @config['chef']['wonga']['build_password'] %>",
        "set_to_all_users" => true
      }
    ],
    "sql_database" => {
      "users" => [
        {
          "domain" => "<%= @config['chef']['wonga']['build_domain'] %>",
          "server_roles" => {
            "sysadmin" => "ADD"
          },
          "username" => "<%= @config['chef']['wonga']['build_username'] %>"
        },
        {
          "domain" => "TEST",
          "server_roles" => {
            "sysadmin" => "ADD"
          },
          "username" => "ServiceUser"
        }
      ]
    }
  },
  "wonga_windows" => {
    "hotfixes" => [
      "https://s3-eu-west-1.amazonaws.com/mirror/WindowsHotfixes/Windows6.1-KB2842230-x64.msu",
      "https://s3-eu-west-1.amazonaws.com/mirror/WindowsHotfixes/Windows6.1-KB2749615-x64.msu"
    ]
  },
  "wonga_splunk" => {
    "windows" => {
      "fowarder_version" => "6.1.3-220630",
      "forwarder_installer_url" => "https://s3-eu-west-1.amazonaws.com/mirror/Splunk/splunkforwarder-6.1.3-220630-x64-release.msi"
    },
    "splunk_receiving_indexer" => "monitoring.example.com:9997",
    "splunk_deployment_server" => "monitoring.example.com:8089",
  },
  "wonga_winbind" => {
    "config_data_bag" => "winbind",
    "config_data_bag_item" => "winbind_config"
  }
}
